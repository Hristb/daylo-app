import{j as e,m as x,A as R}from"./animation-ClZgCcJJ.js";import{r as u}from"./react-vendor-BAfStBEd.js";import{a as G,b as U,A as M,g as F}from"./index-CVM1q6SL.js";import{s as z,g as B,p as L,l as P,S as E,o as q,q as J,A as V,H as _,L as K}from"./icons-Bh_7iz_t.js";import"./firebase-BzT1daf4.js";function Q(i){let s=0;for(let l=0;l<i.length;l++)s=i.charCodeAt(l)+((s<<5)-s);const t=Math.abs(s%360);return{primary:`hsl(${t}, 70%, 50%)`,secondary:`hsl(${(t+60)%360}, 75%, 55%)`,accent:`hsl(${(t+120)%360}, 80%, 60%)`,bg:`hsl(${(t+180)%360}, 60%, 92%)`}}function W(i){const s=["gradient","geometric","pixel","stripe"],t=i.charCodeAt(0)%s.length;return s[t]}function X(i){const s=i.trim().split(" ");return s.length>=2?(s[0][0]+s[s.length-1][0]).toUpperCase():i.slice(0,2).toUpperCase()}function Y(i,s,t){if(i==="gradient")return`
      <circle cx="60" cy="60" r="60" fill="url(#mainGradient)"/>
      <circle cx="45" cy="45" r="25" fill="${s.accent}" opacity="0.15"/>
      <circle cx="80" cy="75" r="20" fill="${s.secondary}" opacity="0.12"/>
    `;if(i==="geometric"){const l=t.split("").reduce((n,o)=>n+o.charCodeAt(0),0);let d=`<circle cx="60" cy="60" r="60" fill="${s.bg}"/>`;for(let n=0;n<6;n++){const o=l*(n+1)%80+20,v=l*(n+2)%80+20,y=l*(n+3)%12+8,f=n%2===0?s.primary:s.secondary;d+=`<circle cx="${o}" cy="${v}" r="${y}" fill="${f}" opacity="0.15"/>`}return d}else if(i==="pixel"){const l=t.split("").reduce((n,o)=>n+o.charCodeAt(0),0);let d=`<rect width="120" height="120" fill="${s.bg}"/>`;for(let n=0;n<8;n++)for(let o=0;o<8;o++){const v=n*8+o;l>>v&1&&(d+=`<rect x="${o*15}" y="${n*15}" width="15" height="15" fill="${s.primary}" opacity="0.2" rx="2"/>`)}return d}else return`
      <rect width="120" height="120" fill="${s.bg}"/>
      <rect x="0" y="15" width="120" height="15" fill="${s.primary}" opacity="0.15"/>
      <rect x="0" y="45" width="120" height="15" fill="${s.secondary}" opacity="0.12"/>
      <rect x="0" y="75" width="120" height="15" fill="${s.accent}" opacity="0.1"/>
    `}function Z({name:i,email:s,size:t=120}){const l=Q(i+s),d=W(i),n=X(i);let o=`<svg width="${t}" height="${t}" viewBox="0 0 120 120" xmlns="http://www.w3.org/2000/svg" style="border-radius: 50%;">`;return o+=`
    <defs>
      <linearGradient id="mainGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:${l.primary};stop-opacity:0.9" />
        <stop offset="100%" style="stop-color:${l.secondary};stop-opacity:0.7" />
      </linearGradient>
      <linearGradient id="textGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:white;stop-opacity:1" />
        <stop offset="100%" style="stop-color:white;stop-opacity:0.9" />
      </linearGradient>
    </defs>
  `,o+=Y(d,l,s),o+='<circle cx="60" cy="60" r="35" fill="white" opacity="0.25"/>',o+=`
    <text 
      x="60" 
      y="60" 
      text-anchor="middle" 
      dominant-baseline="central" 
      font-family="system-ui, -apple-system, sans-serif" 
      font-size="32" 
      font-weight="700" 
      fill="url(#textGradient)"
      style="text-shadow: 0 2px 4px rgba(0,0,0,0.1);"
    >${n}</text>
  `,o+='<circle cx="60" cy="60" r="58" fill="none" stroke="white" stroke-width="2.5" opacity="0.4"/>',o+="</svg>",o}function ee({name:i,email:s,size:t=120,className:l=""}){const d=Z({name:i,email:s,size:t});return e.jsx("div",{className:`inline-block rounded-full overflow-hidden shadow-lg ${l}`,style:{width:t,height:t},dangerouslySetInnerHTML:{__html:d}})}function te(){const[i,s]=u.useState(!1),[t,l]=u.useState("activities"),[d,n]=u.useState(7),[o,v]=u.useState([]),[y,f]=u.useState([]),[C,N]=u.useState(!1);u.useEffect(()=>{i&&D()},[i,d]);const D=async()=>{N(!0);try{const r=JSON.parse(localStorage.getItem("daylo-activity-history")||"[]"),a=JSON.parse(localStorage.getItem("daylo-time-history")||"[]"),m=new Date;m.setDate(m.getDate()-d);const g=m.toISOString().split("T")[0],c=r.filter(h=>h.date>=g),p=a.filter(h=>h.date>=g);v(c),f(p);try{const[h,k]=await Promise.all([G(d),U(d)]);(h.length>0||k.length>0)&&(v(h),f(k),console.log("âœ… Historial cargado desde Firebase"))}catch{console.log("âš ï¸ Firebase no disponible, usando datos locales")}}catch(r){console.error("Error cargando historial:",r)}finally{N(!1)}},S=r=>{const a={};return r.forEach(m=>{a[m.date]||(a[m.date]=[]),a[m.date].push(m)}),a},w=S(o),b=S(y),j=r=>{const a=new Date(r),m=new Date().toISOString().split("T")[0],g=new Date(Date.now()-864e5).toISOString().split("T")[0];return r===m?"ðŸŒŸ Hoy":r===g?"ðŸ“… Ayer":a.toLocaleDateString("es-ES",{weekday:"short",month:"short",day:"numeric"})},T=r=>r.reduce((a,m)=>a+m.duration,0);return e.jsxs(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-2xl border-2 border-green-200 overflow-hidden shadow-sm",children:[e.jsxs("button",{onClick:()=>s(!i),className:"w-full px-6 py-4 flex items-center justify-between hover:bg-green-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-green-400 to-teal-400 rounded-xl flex items-center justify-center",children:e.jsx(z,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"ðŸ“Š Historial de Actividades"}),e.jsxs("p",{className:"text-sm text-green-600",children:[o.length," actividades registradas"]})]})]}),e.jsx(x.div,{animate:{rotate:i?180:0},transition:{duration:.3},children:e.jsx(B,{className:"w-6 h-6 text-green-500"})})]}),e.jsx(R,{children:i&&e.jsx(x.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"border-t-2 border-green-100",children:e.jsxs("div",{className:"p-6 bg-gradient-to-br from-green-50/50 to-teal-50/50",children:[e.jsxs("div",{className:"mb-4 flex gap-2 flex-wrap",children:[e.jsx("button",{onClick:()=>n(7),className:`px-4 py-2 rounded-lg text-sm font-semibold transition-all ${d===7?"bg-green-500 text-white shadow-md":"bg-white text-gray-600 hover:bg-green-100"}`,children:"Ãšltima semana"}),e.jsx("button",{onClick:()=>n(30),className:`px-4 py-2 rounded-lg text-sm font-semibold transition-all ${d===30?"bg-green-500 text-white shadow-md":"bg-white text-gray-600 hover:bg-green-100"}`,children:"Ãšltimo mes"}),e.jsx("button",{onClick:()=>n(90),className:`px-4 py-2 rounded-lg text-sm font-semibold transition-all ${d===90?"bg-green-500 text-white shadow-md":"bg-white text-gray-600 hover:bg-green-100"}`,children:"3 meses"})]}),e.jsxs("div",{className:"mb-4 flex bg-white rounded-xl p-1 border-2 border-green-200",children:[e.jsx("button",{onClick:()=>l("activities"),className:`flex-1 py-2 px-4 rounded-lg font-semibold text-sm transition-all ${t==="activities"?"bg-gradient-to-r from-green-400 to-teal-400 text-white shadow-md":"text-gray-600"}`,children:"ðŸ“‹ Actividades Detalladas"}),e.jsx("button",{onClick:()=>l("time"),className:`flex-1 py-2 px-4 rounded-lg font-semibold text-sm transition-all ${t==="time"?"bg-gradient-to-r from-green-400 to-teal-400 text-white shadow-md":"text-gray-600"}`,children:"â±ï¸ Registro de Horas"})]}),C?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(x.div,{className:"w-12 h-12 mx-auto border-4 border-green-200 border-t-green-500 rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}),e.jsx("p",{className:"text-sm text-gray-500 mt-4",children:"Cargando historial..."})]}):t==="activities"?e.jsx("div",{className:"space-y-4",children:Object.keys(w).length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(z,{className:"w-12 h-12 mx-auto mb-3 text-gray-400"}),e.jsx("p",{className:"text-sm",children:"No hay actividades registradas"}),e.jsx("p",{className:"text-xs mt-1",children:"Comienza agregando actividades para ver tu historial"})]}):Object.keys(w).sort((r,a)=>new Date(a).getTime()-new Date(r).getTime()).map(r=>e.jsxs(x.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-white rounded-xl border-2 border-green-200 overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-green-100 to-teal-100 px-4 py-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"w-4 h-4 text-green-700"}),e.jsx("span",{className:"font-semibold text-gray-800 text-sm",children:j(r)})]}),e.jsxs("span",{className:"text-xs font-semibold text-green-700",children:[w[r].length," actividades"]})]}),e.jsx("div",{className:"divide-y divide-green-100",children:w[r].map(a=>e.jsx("div",{className:"px-4 py-3 hover:bg-green-50 transition-colors",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(M,{type:a.activityIcon,size:24})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"font-semibold text-gray-800 text-sm",children:a.activityLabel}),e.jsxs("span",{className:"text-sm font-bold text-green-600",children:[Math.floor(a.duration/60),"h ",a.duration%60,"m"]})]}),a.notes&&e.jsxs("p",{className:"text-xs text-gray-600 mb-1",children:["ðŸ’­ ",a.notes]}),a.facets&&Object.keys(a.facets).length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:Object.entries(a.facets).map(([m,g])=>e.jsx("span",{className:"px-2 py-0.5 bg-green-100 text-green-700 rounded-full text-[10px] font-medium",children:typeof g=="boolean"?g?"âœ“":"âœ—":`${g}/5`},m))}),e.jsx("span",{className:"text-[10px] text-gray-400 mt-1 block",children:new Date(a.timestamp).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})})]})]})},a.id))})]},r))}):e.jsx("div",{className:"space-y-4",children:Object.keys(b).length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(P,{className:"w-12 h-12 mx-auto mb-3 text-gray-400"}),e.jsx("p",{className:"text-sm",children:"No hay registros de tiempo"}),e.jsx("p",{className:"text-xs mt-1",children:"Las horas trabajadas aparecerÃ¡n aquÃ­"})]}):Object.keys(b).sort((r,a)=>new Date(a).getTime()-new Date(r).getTime()).map(r=>e.jsxs(x.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-white rounded-xl border-2 border-teal-200 overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-teal-100 to-cyan-100 px-4 py-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"w-4 h-4 text-teal-700"}),e.jsx("span",{className:"font-semibold text-gray-800 text-sm",children:j(r)})]}),e.jsxs("span",{className:"text-sm font-bold text-teal-700",children:[Math.floor(T(b[r])/60),"h"," ",T(b[r])%60,"m"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-teal-50 text-xs text-gray-600",children:[e.jsx("th",{className:"text-left px-4 py-2 font-semibold",children:"Actividad"}),e.jsx("th",{className:"text-right px-4 py-2 font-semibold",children:"DuraciÃ³n"}),e.jsx("th",{className:"text-right px-4 py-2 font-semibold",children:"Hora"})]})}),e.jsx("tbody",{className:"divide-y divide-teal-100",children:b[r].map(a=>e.jsxs("tr",{className:"hover:bg-teal-50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{type:a.activityIcon,size:20}),e.jsx("span",{className:"text-sm text-gray-800",children:a.activityLabel})]})}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("span",{className:"text-sm font-semibold text-teal-600",children:[Math.floor(a.duration/60),"h ",a.duration%60,"m"]})}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsx("span",{className:"text-xs text-gray-500",children:new Date(a.timestamp).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})})})]},a.id))})]})})]},r))})]})})})]})}function ne(){const i=localStorage.getItem("daylo-user-name")||"Usuario",s=localStorage.getItem("daylo-user-email")||"",[t,l]=u.useState({totalDays:0,currentStreak:0,longestStreak:0,totalActivities:0,totalTasks:0,completedTasks:0,averageRating:0,favoriteActivity:""}),[d,n]=u.useState(!0);u.useEffect(()=>{o();const y=()=>{document.hidden||o()};return document.addEventListener("visibilitychange",y),()=>document.removeEventListener("visibilitychange",y)},[]);const o=async()=>{try{let f=JSON.parse(localStorage.getItem("daylo-entries")||"[]");try{const c=await F();c.length>0&&(f=c)}catch{console.log("âš ï¸ Firebase no disponible, usando datos locales")}if(f.length===0){n(!1);return}const C=f.length;let N=0,D=0,S=0,w=0,b=0;const j={};f.forEach(c=>{var p,h,k,O,H;N+=((p=c.activities)==null?void 0:p.length)||0,(h=c.activities)==null||h.forEach($=>{j[$.label]=(j[$.label]||0)+1}),D+=((k=c.tasks)==null?void 0:k.length)||0,S+=((O=c.tasks)==null?void 0:O.filter($=>$.completed).length)||0,(H=c.reflection)!=null&&H.dayRating&&(w+=c.reflection.dayRating,b++)});const T=Object.keys(j).reduce((c,p)=>j[c]>j[p]?c:p,""),r=f.sort((c,p)=>new Date(p.date).getTime()-new Date(c.date).getTime());let a=0,m=0,g=0;for(let c=0;c<r.length;c++){const p=new Date(r[c].date),h=new Date;h.setDate(h.getDate()-c),p.toDateString()===h.toDateString()?(g++,c===0&&(a=g),m=Math.max(m,g)):g=0}l({totalDays:C,currentStreak:a,longestStreak:m,totalActivities:N,totalTasks:D,completedTasks:S,averageRating:b>0?w/b:0,favoriteActivity:T})}catch(y){console.error("Error loading stats:",y)}finally{n(!1)}},v=()=>{window.confirm("Â¿EstÃ¡s seguro que deseas cerrar sesiÃ³n?")&&(localStorage.removeItem("daylo-user-name"),localStorage.removeItem("daylo-user-email"),localStorage.removeItem("daylo-entries"),localStorage.removeItem("daylo-last-checkin"),localStorage.removeItem("userName"),localStorage.removeItem("userEmail"),window.location.href="/hoy")};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-pink-50 to-blue-50 pb-20",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[e.jsxs(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-purple-400 via-pink-400 to-blue-400 rounded-3xl p-8 mb-6 relative overflow-hidden shadow-xl",children:[e.jsxs("div",{className:"absolute inset-0 opacity-20",children:[e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-64 h-64 bg-white rounded-full blur-3xl"})]}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center text-center",children:[e.jsxs(x.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{type:"spring",stiffness:150,damping:12},className:"mb-4 relative group",children:[e.jsx(x.div,{className:"absolute inset-0 rounded-full",animate:{rotate:360,scale:[1,1.05,1]},transition:{rotate:{duration:20,repeat:1/0,ease:"linear"},scale:{duration:3,repeat:1/0,ease:"easeInOut"}},style:{background:"conic-gradient(from 0deg, rgba(255,255,255,0.4), transparent, rgba(255,255,255,0.4))",filter:"blur(2px)",transform:"scale(1.15)"}}),e.jsxs("div",{className:"relative",children:[e.jsx(ee,{name:i,email:s,size:140,className:"drop-shadow-2xl ring-4 ring-white/30"}),e.jsx(x.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.3,type:"spring"},className:"absolute -bottom-2 -right-2 bg-white rounded-full p-2 shadow-xl",title:"Tu identicon Ãºnico generado automÃ¡ticamente",children:e.jsx(E,{className:"w-5 h-5 text-purple-500"})})]})]}),e.jsx("h1",{className:"text-3xl font-bold text-white mb-2 drop-shadow-lg",children:i}),e.jsxs("div",{className:"flex items-center gap-2 text-white/90 mb-4",children:[e.jsx(q,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:s})]}),e.jsxs(x.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:.2},className:"inline-flex items-center gap-2 bg-white/20 backdrop-blur-sm px-4 py-2 rounded-full text-white text-sm",children:[e.jsx(E,{className:"w-4 h-4"}),e.jsx("span",{children:"Usuario Daylo"})]})]})]}),d?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin w-12 h-12 border-4 border-purple-400 border-t-transparent rounded-full mx-auto"}),e.jsx("p",{className:"text-gray-500 mt-4",children:"Cargando estadÃ­sticas..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsx(A,{icon:e.jsx(L,{className:"w-5 h-5"}),label:"DÃ­as registrados",value:t.totalDays,color:"from-blue-400 to-cyan-400"}),e.jsx(A,{icon:e.jsx(J,{className:"w-5 h-5"}),label:"Racha actual",value:t.currentStreak,suffix:" dÃ­as",color:"from-green-400 to-emerald-400"}),e.jsx(A,{icon:e.jsx(V,{className:"w-5 h-5"}),label:"Mejor racha",value:t.longestStreak,suffix:" dÃ­as",color:"from-yellow-400 to-orange-400"}),e.jsx(A,{icon:e.jsx(_,{className:"w-5 h-5"}),label:"Promedio dÃ­a",value:t.averageRating.toFixed(1),suffix:"/5",color:"from-pink-400 to-rose-400"})]}),e.jsxs(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100 mb-6",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-800 mb-4",children:"ðŸ“Š Tu Actividad"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(I,{label:"Actividades registradas",value:t.totalActivities}),e.jsx(I,{label:"Tareas creadas",value:t.totalTasks}),e.jsx(I,{label:"Tareas completadas",value:t.completedTasks,extra:t.totalTasks>0?`${Math.round(t.completedTasks/t.totalTasks*100)}% completitud`:""}),t.favoriteActivity&&e.jsx(I,{label:"Actividad favorita",value:t.favoriteActivity,isText:!0})]})]}),t.currentStreak>0&&e.jsxs(x.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.4},className:"bg-gradient-to-r from-purple-100 to-pink-100 rounded-2xl p-6 mb-6 border border-purple-200",children:[e.jsxs("h3",{className:"font-bold text-purple-800 mb-2 flex items-center gap-2",children:[e.jsx(E,{className:"w-5 h-5"}),"Â¡Sigue asÃ­!"]}),e.jsxs("p",{className:"text-purple-700 text-sm",children:[t.currentStreak>=7&&"ðŸ”¥ Â¡IncreÃ­ble! Llevas una semana completa registrando tu vida.",t.currentStreak>=3&&t.currentStreak<7&&"â­ Â¡Excelente! EstÃ¡s construyendo un hÃ¡bito poderoso.",t.currentStreak<3&&"ðŸ’ª Â¡Buen comienzo! La constancia es la clave del autodescubrimiento."]})]})]}),e.jsx(te,{}),e.jsxs(x.button,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},onClick:v,className:"w-full bg-white hover:bg-red-50 border border-red-200 text-red-600 font-semibold py-4 rounded-2xl flex items-center justify-center gap-2 transition-colors",children:[e.jsx(K,{className:"w-5 h-5"}),"Cerrar SesiÃ³n"]})]})})}function A({icon:i,label:s,value:t,suffix:l="",color:d}){return e.jsxs(x.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},whileHover:{scale:1.05},className:`bg-gradient-to-br ${d} rounded-2xl p-4 text-white shadow-lg`,children:[e.jsx("div",{className:"flex items-center justify-center mb-2",children:i}),e.jsxs("div",{className:"text-2xl font-bold text-center mb-1",children:[t,l]}),e.jsx("div",{className:"text-xs text-center opacity-90",children:s})]})}function I({label:i,value:s,extra:t,isText:l=!1}){return e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100 last:border-0",children:[e.jsx("span",{className:"text-sm text-gray-600",children:i}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:`${l?"text-sm":"text-lg"} font-bold text-gray-800`,children:s}),t&&e.jsx("span",{className:"text-xs text-gray-500 block",children:t})]})]})}export{ne as default};
