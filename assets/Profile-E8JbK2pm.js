import{j as e,m as d}from"./animation-ClZgCcJJ.js";import{r as j}from"./react-vendor-BAfStBEd.js";import{g as G}from"./index-BXDQdgM0.js";import{S as N,m as U,n as z,T as M,A as H,H as O,L as B}from"./icons-B4WAHLkG.js";import"./firebase-DpXdI3fe.js";function F(s){let a=0;for(let i=0;i<s.length;i++)a=s.charCodeAt(i)+((a<<5)-a);const t=Math.abs(a%360);return{primary:`hsl(${t}, 70%, 50%)`,secondary:`hsl(${(t+60)%360}, 75%, 55%)`,accent:`hsl(${(t+120)%360}, 80%, 60%)`,bg:`hsl(${(t+180)%360}, 60%, 92%)`}}function P(s){const a=["gradient","geometric","pixel","stripe"],t=s.charCodeAt(0)%a.length;return a[t]}function _(s){const a=s.trim().split(" ");return a.length>=2?(a[0][0]+a[a.length-1][0]).toUpperCase():s.slice(0,2).toUpperCase()}function q(s,a,t){if(s==="gradient")return`
      <circle cx="60" cy="60" r="60" fill="url(#mainGradient)"/>
      <circle cx="45" cy="45" r="25" fill="${a.accent}" opacity="0.15"/>
      <circle cx="80" cy="75" r="20" fill="${a.secondary}" opacity="0.12"/>
    `;if(s==="geometric"){const i=t.split("").reduce((o,r)=>o+r.charCodeAt(0),0);let n=`<circle cx="60" cy="60" r="60" fill="${a.bg}"/>`;for(let o=0;o<6;o++){const r=i*(o+1)%80+20,p=i*(o+2)%80+20,m=i*(o+3)%12+8,x=o%2===0?a.primary:a.secondary;n+=`<circle cx="${r}" cy="${p}" r="${m}" fill="${x}" opacity="0.15"/>`}return n}else if(s==="pixel"){const i=t.split("").reduce((o,r)=>o+r.charCodeAt(0),0);let n=`<rect width="120" height="120" fill="${a.bg}"/>`;for(let o=0;o<8;o++)for(let r=0;r<8;r++){const p=o*8+r;i>>p&1&&(n+=`<rect x="${r*15}" y="${o*15}" width="15" height="15" fill="${a.primary}" opacity="0.2" rx="2"/>`)}return n}else return`
      <rect width="120" height="120" fill="${a.bg}"/>
      <rect x="0" y="15" width="120" height="15" fill="${a.primary}" opacity="0.15"/>
      <rect x="0" y="45" width="120" height="15" fill="${a.secondary}" opacity="0.12"/>
      <rect x="0" y="75" width="120" height="15" fill="${a.accent}" opacity="0.1"/>
    `}function J({name:s,email:a,size:t=120}){const i=F(s+a),n=P(s),o=_(s);let r=`<svg width="${t}" height="${t}" viewBox="0 0 120 120" xmlns="http://www.w3.org/2000/svg" style="border-radius: 50%;">`;return r+=`
    <defs>
      <linearGradient id="mainGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:${i.primary};stop-opacity:0.9" />
        <stop offset="100%" style="stop-color:${i.secondary};stop-opacity:0.7" />
      </linearGradient>
      <linearGradient id="textGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:white;stop-opacity:1" />
        <stop offset="100%" style="stop-color:white;stop-opacity:0.9" />
      </linearGradient>
    </defs>
  `,r+=q(n,i,a),r+='<circle cx="60" cy="60" r="35" fill="white" opacity="0.25"/>',r+=`
    <text 
      x="60" 
      y="60" 
      text-anchor="middle" 
      dominant-baseline="central" 
      font-family="system-ui, -apple-system, sans-serif" 
      font-size="32" 
      font-weight="700" 
      fill="url(#textGradient)"
      style="text-shadow: 0 2px 4px rgba(0,0,0,0.1);"
    >${o}</text>
  `,r+='<circle cx="60" cy="60" r="58" fill="none" stroke="white" stroke-width="2.5" opacity="0.4"/>',r+="</svg>",r}function V({name:s,email:a,size:t=120,className:i=""}){const n=J({name:s,email:a,size:t});return e.jsx("div",{className:`inline-block rounded-full overflow-hidden shadow-lg ${i}`,style:{width:t,height:t},dangerouslySetInnerHTML:{__html:n}})}function Z(){const s=localStorage.getItem("daylo-user-name")||"Usuario",a=localStorage.getItem("daylo-user-email")||"",[t,i]=j.useState({totalDays:0,currentStreak:0,longestStreak:0,totalActivities:0,totalTasks:0,completedTasks:0,averageRating:0,favoriteActivity:""}),[n,o]=j.useState(!0);j.useEffect(()=>{r();const m=()=>{document.hidden||r()};return document.addEventListener("visibilitychange",m),()=>document.removeEventListener("visibilitychange",m)},[]);const r=async()=>{try{let x=JSON.parse(localStorage.getItem("daylo-entries")||"[]");try{const l=await G();l.length>0&&(x=l)}catch{console.log("âš ï¸ Firebase no disponible, usando datos locales")}if(x.length===0){o(!1);return}const L=x.length;let k=0,S=0,$=0,T=0,v=0;const u={};x.forEach(l=>{var c,h,D,I,C;k+=((c=l.activities)==null?void 0:c.length)||0,(h=l.activities)==null||h.forEach(f=>{u[f.label]=(u[f.label]||0)+1}),S+=((D=l.tasks)==null?void 0:D.length)||0,$+=((I=l.tasks)==null?void 0:I.filter(f=>f.completed).length)||0,(C=l.reflection)!=null&&C.dayRating&&(T+=l.reflection.dayRating,v++)});const R=Object.keys(u).reduce((l,c)=>u[l]>u[c]?l:c,""),A=x.sort((l,c)=>new Date(c.date).getTime()-new Date(l.date).getTime());let E=0,w=0,g=0;for(let l=0;l<A.length;l++){const c=new Date(A[l].date),h=new Date;h.setDate(h.getDate()-l),c.toDateString()===h.toDateString()?(g++,l===0&&(E=g),w=Math.max(w,g)):g=0}i({totalDays:L,currentStreak:E,longestStreak:w,totalActivities:k,totalTasks:S,completedTasks:$,averageRating:v>0?T/v:0,favoriteActivity:R})}catch(m){console.error("Error loading stats:",m)}finally{o(!1)}},p=()=>{window.confirm("Â¿EstÃ¡s seguro que deseas cerrar sesiÃ³n?")&&(localStorage.removeItem("daylo-user-name"),localStorage.removeItem("daylo-user-email"),localStorage.removeItem("daylo-entries"),localStorage.removeItem("daylo-last-checkin"),localStorage.removeItem("userName"),localStorage.removeItem("userEmail"),window.location.href="/hoy")};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-pink-50 to-blue-50 pb-20",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-purple-400 via-pink-400 to-blue-400 rounded-3xl p-8 mb-6 relative overflow-hidden shadow-xl",children:[e.jsxs("div",{className:"absolute inset-0 opacity-20",children:[e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-64 h-64 bg-white rounded-full blur-3xl"})]}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center text-center",children:[e.jsxs(d.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{type:"spring",stiffness:150,damping:12},className:"mb-4 relative group",children:[e.jsx(d.div,{className:"absolute inset-0 rounded-full",animate:{rotate:360,scale:[1,1.05,1]},transition:{rotate:{duration:20,repeat:1/0,ease:"linear"},scale:{duration:3,repeat:1/0,ease:"easeInOut"}},style:{background:"conic-gradient(from 0deg, rgba(255,255,255,0.4), transparent, rgba(255,255,255,0.4))",filter:"blur(2px)",transform:"scale(1.15)"}}),e.jsxs("div",{className:"relative",children:[e.jsx(V,{name:s,email:a,size:140,className:"drop-shadow-2xl ring-4 ring-white/30"}),e.jsx(d.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.3,type:"spring"},className:"absolute -bottom-2 -right-2 bg-white rounded-full p-2 shadow-xl",title:"Tu identicon Ãºnico generado automÃ¡ticamente",children:e.jsx(N,{className:"w-5 h-5 text-purple-500"})})]})]}),e.jsx("h1",{className:"text-3xl font-bold text-white mb-2 drop-shadow-lg",children:s}),e.jsxs("div",{className:"flex items-center gap-2 text-white/90 mb-4",children:[e.jsx(U,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:a})]}),e.jsxs(d.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:.2},className:"inline-flex items-center gap-2 bg-white/20 backdrop-blur-sm px-4 py-2 rounded-full text-white text-sm",children:[e.jsx(N,{className:"w-4 h-4"}),e.jsx("span",{children:"Usuario Daylo"})]})]})]}),n?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin w-12 h-12 border-4 border-purple-400 border-t-transparent rounded-full mx-auto"}),e.jsx("p",{className:"text-gray-500 mt-4",children:"Cargando estadÃ­sticas..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsx(y,{icon:e.jsx(z,{className:"w-5 h-5"}),label:"DÃ­as registrados",value:t.totalDays,color:"from-blue-400 to-cyan-400"}),e.jsx(y,{icon:e.jsx(M,{className:"w-5 h-5"}),label:"Racha actual",value:t.currentStreak,suffix:" dÃ­as",color:"from-green-400 to-emerald-400"}),e.jsx(y,{icon:e.jsx(H,{className:"w-5 h-5"}),label:"Mejor racha",value:t.longestStreak,suffix:" dÃ­as",color:"from-yellow-400 to-orange-400"}),e.jsx(y,{icon:e.jsx(O,{className:"w-5 h-5"}),label:"Promedio dÃ­a",value:t.averageRating.toFixed(1),suffix:"/5",color:"from-pink-400 to-rose-400"})]}),e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100 mb-6",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-800 mb-4",children:"ðŸ“Š Tu Actividad"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(b,{label:"Actividades registradas",value:t.totalActivities}),e.jsx(b,{label:"Tareas creadas",value:t.totalTasks}),e.jsx(b,{label:"Tareas completadas",value:t.completedTasks,extra:t.totalTasks>0?`${Math.round(t.completedTasks/t.totalTasks*100)}% completitud`:""}),t.favoriteActivity&&e.jsx(b,{label:"Actividad favorita",value:t.favoriteActivity,isText:!0})]})]}),t.currentStreak>0&&e.jsxs(d.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.4},className:"bg-gradient-to-r from-purple-100 to-pink-100 rounded-2xl p-6 mb-6 border border-purple-200",children:[e.jsxs("h3",{className:"font-bold text-purple-800 mb-2 flex items-center gap-2",children:[e.jsx(N,{className:"w-5 h-5"}),"Â¡Sigue asÃ­!"]}),e.jsxs("p",{className:"text-purple-700 text-sm",children:[t.currentStreak>=7&&"ðŸ”¥ Â¡IncreÃ­ble! Llevas una semana completa registrando tu vida.",t.currentStreak>=3&&t.currentStreak<7&&"â­ Â¡Excelente! EstÃ¡s construyendo un hÃ¡bito poderoso.",t.currentStreak<3&&"ðŸ’ª Â¡Buen comienzo! La constancia es la clave del autodescubrimiento."]})]})]}),e.jsxs(d.button,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},onClick:p,className:"w-full bg-white hover:bg-red-50 border border-red-200 text-red-600 font-semibold py-4 rounded-2xl flex items-center justify-center gap-2 transition-colors",children:[e.jsx(B,{className:"w-5 h-5"}),"Cerrar SesiÃ³n"]})]})})}function y({icon:s,label:a,value:t,suffix:i="",color:n}){return e.jsxs(d.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},whileHover:{scale:1.05},className:`bg-gradient-to-br ${n} rounded-2xl p-4 text-white shadow-lg`,children:[e.jsx("div",{className:"flex items-center justify-center mb-2",children:s}),e.jsxs("div",{className:"text-2xl font-bold text-center mb-1",children:[t,i]}),e.jsx("div",{className:"text-xs text-center opacity-90",children:a})]})}function b({label:s,value:a,extra:t,isText:i=!1}){return e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100 last:border-0",children:[e.jsx("span",{className:"text-sm text-gray-600",children:s}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:`${i?"text-sm":"text-lg"} font-bold text-gray-800`,children:a}),t&&e.jsx("span",{className:"text-xs text-gray-500 block",children:t})]})]})}export{Z as default};
