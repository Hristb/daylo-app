import{j as e,m as u,A as L}from"./animation-CGUQWomD.js";import{r as y}from"./react-vendor-DRMccTfR.js";import{A as V,c as q,s as B,d as G,t as X}from"./index-BCYywqxi.js";import{X as _,m as A,t as R,u as z,v as K,w as U,x as Q,q as W,A as Z}from"./icons-DbjOiOOr.js";import"./firebase-C-zsfMAV.js";function C(){const s=new Date,t=-5*60,a=s.getTime()+s.getTimezoneOffset()*6e4;return new Date(a+t*6e4)}function ee(s,t){return new Date(s,t+1,0).getDate()}function te(s,t){return new Date(s,t,1).getDay()}function f(s){const t=s.getFullYear(),a=String(s.getMonth()+1).padStart(2,"0"),i=String(s.getDate()).padStart(2,"0");return`${t}-${a}-${i}`}function I(s,t){const a=typeof s=="string"?new Date(s):s,i=typeof t=="string"?new Date(t):t;return f(a)===f(i)}function H(s){return I(s,C())}function J(s){const t=typeof s=="string"?new Date(s):s,a=C();return a.setHours(0,0,0,0),t.setHours(0,0,0,0),t>a}function O(s){var i,x;if(!s)return"bg-white hover:bg-gray-50/50";const t=((i=s.reflection)==null?void 0:i.dayRating)||0,a=((x=s.activities)==null?void 0:x.length)||0;return t>=4&&a>=3?"bg-purple-100/60 hover:bg-purple-100":t>=3&&a>=2?"bg-purple-50/80 hover:bg-purple-100/70":t>=2?"bg-pink-50/80 hover:bg-pink-100/70":t>=1?"bg-blue-50/60 hover:bg-blue-100/60":"bg-gray-50/50 hover:bg-gray-100/60"}function se(s){return["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][s]}function ae(s){if(s.length===0)return{current:0,longest:0};const t=s.map(o=>new Date(o.date)).sort((o,m)=>m.getTime()-o.getTime());let a=0,i=0,x=0;for(let o=0;o<t.length;o++){const m=t[o],p=C();p.setDate(p.getDate()-o),I(m,p)?(x++,o===0&&(a=x),i=Math.max(i,x)):x=0}return{current:a,longest:i}}function re({date:s,dayNumber:t,entry:a,events:i,onClick:x}){var h,w,D;const o=!!(a&&(a.activities&&a.activities.length>0||a.tasks&&a.tasks.length>0||a.diaryNote||(h=a.reflection)!=null&&h.dayRating)),m=i.length>0,p=H(s),c=J(s),d=i.some(b=>b.type==="important-date"),N=i.some(b=>b.type==="reminder");let g=o?O(a):"bg-white hover:bg-gray-50/50";return d&&c?g="bg-gradient-to-br from-yellow-50/80 via-pink-50/60 to-purple-50/80 hover:from-yellow-100/90 hover:via-pink-100/70 hover:to-purple-100/90":d&&!c&&(g=o?O(a):"bg-purple-50/40 hover:bg-purple-100/50"),e.jsxs(u.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:x,className:`
        relative aspect-square rounded-lg border-2 transition-all
        ${g}
        ${p?"border-purple-300 shadow-sm shadow-purple-200":d&&c?"border-yellow-300/60 shadow-sm shadow-yellow-200/40":c?"border-blue-100/50":"border-gray-100/50"}
        text-gray-700
      `,title:`${t} - ${o?"Registrado":m?"Con eventos":"Sin datos"}`,children:[e.jsx("span",{className:`
        absolute top-1 left-1 text-xs font-semibold
        ${p?"text-purple-600":c?"text-blue-400/70":"text-gray-500"}
      `,children:t}),p&&e.jsx(u.div,{initial:{scale:0},animate:{scale:1},className:"hidden sm:block absolute top-1 right-1 text-sm",children:"‚ú®"}),m&&c&&e.jsx(u.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},className:"hidden sm:block absolute top-1 right-1 text-base",title:d?"D√≠a importante":N?"Recordatorio":"Evento",children:d?"‚≠ê":N?"üìå":"üìÖ"}),m&&!c&&!p&&e.jsx(u.div,{initial:{opacity:0},animate:{opacity:1},className:"hidden sm:block absolute top-1 right-1 text-xs opacity-40",children:d?"‚≠ê":"üìç"}),o&&((w=a.reflection)==null?void 0:w.dayRating)>=4&&e.jsx(u.div,{initial:{rotate:-180,scale:0},animate:{rotate:0,scale:1},className:"hidden sm:block absolute bottom-1 left-1 text-sm",children:"üî•"}),o&&((D=a.activities)==null?void 0:D.length)>0&&e.jsx("div",{className:"absolute bottom-1 left-1/2 transform -translate-x-1/2 flex gap-0.5",children:Array.from({length:Math.min(a.activities.length,3)}).map((b,E)=>e.jsx("div",{className:"w-1 h-1 rounded-full bg-purple-300/40"},E))})]})}function ne({date:s,entry:t,events:a,onClose:i,onAddEvent:x,onDeleteEvent:o,onToggleEvent:m}){var k;const[p,c]=y.useState(!1),[d,N]=y.useState("event"),[g,h]=y.useState(""),w=s.getDate(),D=s.toLocaleDateString("es-ES",{month:"long"}),b=s.getFullYear(),E=H(s),S=J(s),F=()=>{g.trim()&&(x({date:f(s),type:d,description:g.trim(),completed:!1}),h(""),c(!1))};return e.jsx(L,{children:e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx(u.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:i,className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),e.jsxs(u.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},className:"relative bg-white rounded-3xl shadow-2xl max-w-lg w-full max-h-[80vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-gradient-to-br from-purple-400 via-pink-400 to-blue-400 p-6 rounded-t-3xl",children:[e.jsx("button",{onClick:i,className:"absolute top-4 right-4 p-2 bg-white/20 hover:bg-white/30 rounded-full transition",children:e.jsx(_,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"flex items-center gap-3 text-white",children:[e.jsx(A,{className:"w-6 h-6"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:E?"üåü HOY":`${w} de ${D}`}),e.jsx("p",{className:"text-sm opacity-90",children:b})]})]})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[t&&!S&&e.jsxs(e.Fragment,{children:[((k=t.reflection)==null?void 0:k.dayRating)&&e.jsxs("div",{className:"bg-purple-50 rounded-xl p-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"‚ú® Valoraci√≥n del d√≠a"}),e.jsxs("div",{className:"flex items-center gap-2",children:[Array.from({length:5}).map((n,v)=>e.jsx("span",{className:"text-2xl",children:v<t.reflection.dayRating?"‚≠ê":"‚òÜ"},v)),e.jsxs("span",{className:"ml-2 font-bold text-purple-600",children:[t.reflection.dayRating,"/5"]})]})]}),t.activities&&t.activities.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-bold text-gray-800 mb-3 flex items-center gap-2",children:[e.jsx("span",{children:"üìä"})," Actividades (",t.activities.length,")"]}),e.jsx("div",{className:"space-y-2",children:t.activities.map((n,v)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-xl",children:[e.jsx(V,{type:n.icon,size:24}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-800",children:n.label}),e.jsxs("p",{className:"text-sm text-gray-500",children:[n.duration," min"]})]})]},v))})]}),t.tasks&&t.tasks.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-bold text-gray-800 mb-3 flex items-center gap-2",children:[e.jsx("span",{children:"‚úÖ"})," Tareas"]}),e.jsx("div",{className:"space-y-2",children:t.tasks.map((n,v)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-xl",children:[n.completed?e.jsx(R,{className:"w-5 h-5 text-green-500"}):e.jsx(z,{className:"w-5 h-5 text-gray-400"}),e.jsx("p",{className:`flex-1 ${n.completed?"line-through text-gray-500":"text-gray-800"}`,children:n.text})]},v))}),e.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:[t.tasks.filter(n=>n.completed).length,"/",t.tasks.length," completadas"]})]}),t.diaryNote&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-bold text-gray-800 mb-3 flex items-center gap-2",children:[e.jsx("span",{children:"üìù"})," Nota del d√≠a"]}),e.jsx("p",{className:"text-gray-700 bg-gray-50 p-4 rounded-xl whitespace-pre-wrap",children:t.diaryNote})]})]}),!t&&!S&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("p",{className:"text-4xl mb-2",children:"üì≠"}),e.jsx("p",{children:"No hay registro de este d√≠a"})]}),a.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-bold text-gray-800 mb-3 flex items-center gap-2",children:[e.jsx("span",{children:"üìå"})," Eventos programados"]}),e.jsx("div",{className:"space-y-2",children:a.map(n=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-blue-50 rounded-xl",children:[e.jsx("button",{onClick:()=>m(n.id),className:"shrink-0",children:n.completed?e.jsx(R,{className:"w-5 h-5 text-green-500"}):e.jsx(z,{className:"w-5 h-5 text-gray-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:`font-medium ${n.completed?"line-through text-gray-500":"text-gray-800"}`,children:n.description}),e.jsx("p",{className:"text-xs text-gray-500 capitalize",children:n.type})]}),e.jsx("button",{onClick:()=>o(n.id),className:"p-1 hover:bg-red-100 rounded-lg transition",children:e.jsx(K,{className:"w-4 h-4 text-red-500"})})]},n.id))})]}),S||E?e.jsx("div",{children:p?e.jsxs(u.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"bg-purple-50 rounded-xl p-4 space-y-3",children:[e.jsx("div",{className:"flex gap-2",children:["event","reminder","important-date"].map(n=>e.jsxs("button",{onClick:()=>N(n),className:`flex-1 py-2 px-3 rounded-lg text-sm transition ${d===n?"bg-purple-500 text-white":"bg-white text-gray-600 hover:bg-gray-100"}`,children:[n==="event"&&"üìÖ Evento",n==="reminder"&&"‚è∞ Recordatorio",n==="important-date"&&"‚≠ê Fecha importante"]},n))}),e.jsx("input",{type:"text",value:g,onChange:n=>h(n.target.value),onKeyPress:n=>n.key==="Enter"&&F(),placeholder:"Descripci√≥n...",className:"w-full px-4 py-2 rounded-lg border border-gray-200 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 outline-none",autoFocus:!0}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>c(!1),className:"flex-1 py-2 bg-white text-gray-600 rounded-lg hover:bg-gray-100 transition",children:"Cancelar"}),e.jsx("button",{onClick:F,className:"flex-1 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition disabled:opacity-50",disabled:!g.trim(),children:"Guardar"})]})]}):e.jsx("button",{onClick:()=>c(!0),className:"w-full py-3 border-2 border-dashed border-gray-300 rounded-xl hover:border-purple-400 hover:bg-purple-50 transition text-gray-600 hover:text-purple-600 font-medium",children:"+ Agregar evento"})}):null]})]})]})})}function le(){const[s,t]=y.useState(C()),[a,i]=y.useState([]),[x,o]=y.useState([]),[m,p]=y.useState(null),c=s.getFullYear(),d=s.getMonth(),N=ee(c,d),g=te(c,d);y.useEffect(()=>{h()},[s]);const h=async()=>{const r=JSON.parse(localStorage.getItem("daylo-entries")||"[]");i(r);try{console.log("üîÑ Cargando eventos desde Firebase...");const l=await q();o(l),localStorage.setItem("daylo-calendar-events",JSON.stringify(l)),console.log(`‚úÖ ${l.length} eventos cargados y sincronizados`)}catch(l){console.error("‚ùå Error cargando eventos desde Firebase:",l);const j=JSON.parse(localStorage.getItem("daylo-calendar-events")||"[]");o(j)}},w=()=>{t(new Date(c,d-1,1))},D=()=>{t(new Date(c,d+1,1))},b=()=>{t(C())},E=async r=>{try{console.log("üíæ Guardando evento en Firebase..."),await B({date:r.date,type:r.type,description:r.description,completed:r.completed||!1})?(console.log("‚úÖ Evento guardado, recargando desde Firebase..."),await h()):console.error("‚ùå No se pudo guardar el evento")}catch(l){console.error("‚ùå Error guardando evento:",l)}},S=async r=>{try{console.log("üóëÔ∏è Eliminando evento de Firebase..."),await G(r)?(console.log("‚úÖ Evento eliminado, recargando desde Firebase..."),await h()):console.error("‚ùå No se pudo eliminar el evento")}catch(l){console.error("‚ùå Error eliminando evento:",l)}},F=async r=>{try{const l=x.find(M=>M.id===r);if(!l)return;const j=!l.completed;console.log(`üîÑ Actualizando estado de evento a ${j?"completado":"pendiente"}...`),await X(r,j)?(console.log("‚úÖ Estado actualizado, recargando desde Firebase..."),await h()):console.error("‚ùå No se pudo actualizar el estado del evento")}catch(l){console.error("‚ùå Error actualizando estado de evento:",l)}},k=[],n=g===0?6:g-1;for(let r=0;r<n;r++)k.push(e.jsx("div",{},`empty-${r}`));for(let r=1;r<=N;r++){const l=new Date(c,d,r),j=f(l),$=a.find(T=>f(new Date(T.date))===j),M=x.filter(T=>T.date===j);k.push(e.jsx(re,{date:l,dayNumber:r,entry:$,events:M,onClick:()=>p(l)},r))}const v=a.filter(r=>{const l=new Date(r.date);return l.getMonth()===d&&l.getFullYear()===c}),Y=ae(a),P=x.filter(r=>new Date(r.date)>C()&&!r.completed).length;return e.jsxs(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-3xl p-6 shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(A,{className:"w-6 h-6 text-purple-500"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Mi Calendario"})]}),e.jsx("button",{onClick:b,className:"px-4 py-2 bg-purple-100 hover:bg-purple-200 text-purple-700 rounded-lg text-sm font-medium transition",children:"Hoy"})]}),e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("button",{onClick:w,className:"p-2 hover:bg-gray-100 rounded-lg transition",children:e.jsx(U,{className:"w-5 h-5 text-gray-600"})}),e.jsxs("h3",{className:"text-lg font-bold text-gray-800",children:[se(d)," ",c]}),e.jsx("button",{onClick:D,className:"p-2 hover:bg-gray-100 rounded-lg transition",children:e.jsx(Q,{className:"w-5 h-5 text-gray-600"})})]}),e.jsx("div",{className:"grid grid-cols-7 gap-2 mb-2",children:["L","M","X","J","V","S","D"].map((r,l)=>e.jsx("div",{className:"text-center text-xs font-semibold text-gray-500 py-2",children:r},l))}),e.jsx("div",{className:"grid grid-cols-7 gap-2 mb-6",children:k}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-4 text-xs text-gray-600 py-4 border-t border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-purple-400"}),e.jsx("span",{children:"Excelente"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-purple-300"}),e.jsx("span",{children:"Muy bueno"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-pink-300"}),e.jsx("span",{children:"Bueno"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-blue-200"}),e.jsx("span",{children:"Normal"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-gray-100 border border-gray-200"}),e.jsx("span",{children:"Sin registro"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 pt-4 border-t border-gray-100",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex items-center justify-center gap-2 text-purple-500 mb-1",children:e.jsx(A,{className:"w-4 h-4"})}),e.jsx("p",{className:"text-2xl font-bold text-gray-800",children:v.length}),e.jsx("p",{className:"text-xs text-gray-500",children:"Este mes"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex items-center justify-center gap-2 text-pink-500 mb-1",children:e.jsx(W,{className:"w-4 h-4"})}),e.jsx("p",{className:"text-2xl font-bold text-gray-800",children:Y.current}),e.jsx("p",{className:"text-xs text-gray-500",children:"Racha actual"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex items-center justify-center gap-2 text-blue-500 mb-1",children:e.jsx(Z,{className:"w-4 h-4"})}),e.jsx("p",{className:"text-2xl font-bold text-gray-800",children:P}),e.jsx("p",{className:"text-xs text-gray-500",children:"Eventos pr√≥ximos"})]})]}),m&&e.jsx(ne,{date:m,entry:a.find(r=>f(new Date(r.date))===f(m)),events:x.filter(r=>r.date===f(m)),onClose:()=>p(null),onAddEvent:E,onDeleteEvent:S,onToggleEvent:F})]})}function me(){return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-pink-50 to-blue-50 pb-20",children:e.jsxs("div",{className:"max-w-5xl mx-auto px-4 py-8",children:[e.jsxs(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"daylo-card text-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"üìÖ Mi Calendario"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Visualiza tu historia, planifica eventos y mant√©n tu racha"})]}),e.jsx(le,{})]})})}export{me as default};
