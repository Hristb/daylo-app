import{j as t,m as r}from"./animation-ClZgCcJJ.js";import{r as c}from"./react-vendor-BAfStBEd.js";import{f as p,g as B}from"./index-CbnMIGRA.js";import{n as L,o as R,j as z,p as T}from"./icons-CGoRCpcN.js";import{R as b,B as O,C as G,X as I,Y as K,T as N,a as P,P as $,b as J,c as U}from"./charts-BCRNSYNv.js";import"./firebase-BzT1daf4.js";function Q(){const[E,j]=c.useState([]),[g,D]=c.useState([]),[x,C]=c.useState([]),[o,F]=c.useState({totalDays:0,averageActivities:0,totalMinutes:0,mostCommonMood:"ğŸ˜Š"});c.useEffect(()=>{const e=async()=>{const d=JSON.parse(localStorage.getItem("daylo-entries")||"[]");j(d),d.length>0&&u(d);try{const n=await B();n.length>0&&(j(n),u(n),localStorage.setItem("daylo-entries",JSON.stringify(n)))}catch(n){console.error("Error cargando datos de Firebase:",n)}};e();const l=()=>{document.hidden||e()};return document.addEventListener("visibilitychange",l),window.addEventListener("focus",e),()=>{document.removeEventListener("visibilitychange",l),window.removeEventListener("focus",e)}},[]);const u=e=>{var v;const l=e.length,n=e.reduce((s,a)=>{var i;return s+(((i=a.activities)==null?void 0:i.length)||0)},0)/l,S=e.reduce((s,a)=>{var i;return s+(((i=a.activities)==null?void 0:i.reduce((h,M)=>h+M.duration,0))||0)},0),m={};e.forEach(s=>{var i;const a=((i=s.reflection)==null?void 0:i.mood)||"ğŸ˜Š";m[a]=(m[a]||0)+1});const w=((v=Object.entries(m).sort((s,a)=>a[1]-s[1])[0])==null?void 0:v[0])||"ğŸ˜Š";F({totalDays:l,averageActivities:Math.round(n*10)/10,totalMinutes:S,mostCommonMood:w});const A=e.slice(-7).map(s=>{var a;return{day:new Date(s.date).toLocaleDateString("es-ES",{weekday:"short"}),minutos:((a=s.activities)==null?void 0:a.reduce((i,h)=>i+h.duration,0))||0}});D(A);const y={};e.forEach(s=>{var a;(a=s.activities)==null||a.forEach(i=>{y[i.label]=(y[i.label]||0)+i.duration})});const k=Object.entries(y).map(([s,a])=>({name:s,value:a})).sort((s,a)=>a.value-s.value).slice(0,6);C(k)},f=["#FFD4E5","#C4E5FF","#E8D4FF","#D4FFE5","#FFE5D4","#FFF4D4"];return E.length===0?t.jsxs(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"daylo-card text-center py-12",children:[t.jsx(r.div,{className:"text-6xl mb-4",animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0},children:"ğŸ“Š"}),t.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"AÃºn no hay datos"}),t.jsx("p",{className:"text-gray-600",children:"Empieza a registrar tus dÃ­as para ver tu dashboard"})]}):t.jsxs("div",{className:"space-y-6 pb-8",children:[t.jsxs(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"daylo-card text-center",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Tu Resumen Semanal"}),t.jsx("p",{className:"text-gray-600 text-sm",children:"AsÃ­ ha sido tu semana en Daylo"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs(r.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.1},className:"daylo-card text-center",children:[t.jsx("div",{className:"flex items-center justify-center mb-2",children:t.jsx(L,{className:"text-pastel-blue",size:24})}),t.jsx("div",{className:"text-3xl font-bold text-gray-800",children:o.totalDays}),t.jsx("div",{className:"text-sm text-gray-600",children:"DÃ­as registrados"})]}),t.jsxs(r.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2},className:"daylo-card text-center",children:[t.jsx("div",{className:"flex items-center justify-center mb-2",children:t.jsx(R,{className:"text-pastel-purple",size:24})}),t.jsx("div",{className:"text-3xl font-bold text-gray-800",children:o.averageActivities}),t.jsx("div",{className:"text-sm text-gray-600",children:"Actividades / dÃ­a"})]}),t.jsxs(r.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.3},className:"daylo-card text-center",children:[t.jsx("div",{className:"flex items-center justify-center mb-2",children:t.jsx(z,{className:"text-pastel-green",size:24})}),t.jsxs("div",{className:"text-3xl font-bold text-gray-800",children:[Math.floor(o.totalMinutes/60),"h"]}),t.jsx("div",{className:"text-sm text-gray-600",children:"Total registrado"})]}),t.jsxs(r.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.4},className:"daylo-card text-center",children:[t.jsx("div",{className:"flex items-center justify-center mb-2",children:t.jsx(T,{className:"text-pastel-yellow",size:24})}),t.jsx("div",{className:"text-4xl font-bold",children:o.mostCommonMood}),t.jsx("div",{className:"text-sm text-gray-600",children:"Estado mÃ¡s comÃºn"})]})]}),g.length>0&&t.jsxs(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"daylo-card",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-4",children:"ğŸ“ˆ Actividad de la semana"}),t.jsx(b,{width:"100%",height:250,children:t.jsxs(O,{data:g,children:[t.jsx(G,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),t.jsx(I,{dataKey:"day",stroke:"#6B7280",style:{fontSize:"12px"}}),t.jsx(K,{stroke:"#6B7280",style:{fontSize:"12px"}}),t.jsx(N,{contentStyle:{backgroundColor:"white",border:"1px solid #E5E7EB",borderRadius:"12px",padding:"8px 12px"},formatter:e=>[p(e),"Tiempo"]}),t.jsx(P,{dataKey:"minutos",fill:"url(#colorGradient)",radius:[8,8,0,0]}),t.jsx("defs",{children:t.jsxs("linearGradient",{id:"colorGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[t.jsx("stop",{offset:"0%",stopColor:"#E8D4FF"}),t.jsx("stop",{offset:"100%",stopColor:"#C4E5FF"})]})})]})})]}),x.length>0&&t.jsxs(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},className:"daylo-card",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-4",children:"ğŸ¯ Â¿En quÃ© pasas tu tiempo?"}),t.jsx(b,{width:"100%",height:300,children:t.jsxs($,{children:[t.jsx(J,{data:x,cx:"50%",cy:"50%",labelLine:!1,label:({name:e,percent:l})=>`${e} ${(l*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:x.map((e,l)=>t.jsx(U,{fill:f[l%f.length]},`cell-${l}`))}),t.jsx(N,{formatter:e=>p(e),contentStyle:{backgroundColor:"white",border:"1px solid #E5E7EB",borderRadius:"12px",padding:"8px 12px"}})]})})]}),t.jsxs(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7},className:"daylo-card bg-gradient-to-r from-pastel-pink/30 to-pastel-purple/30",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-3 flex items-center gap-2",children:"ğŸ’¡ Insights"}),t.jsxs("ul",{className:"space-y-2 text-sm text-gray-700",children:[t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{children:"âœ¨"}),t.jsxs("span",{children:["Llevas ",t.jsxs("strong",{children:[o.totalDays," dÃ­as"]})," registrando tu vida en Daylo"]})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{children:"â±ï¸"}),t.jsxs("span",{children:["Has registrado un total de ",t.jsx("strong",{children:p(o.totalMinutes)})]})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{children:"ğŸ“Š"}),t.jsxs("span",{children:["Tu estado mÃ¡s frecuente es ",t.jsx("strong",{children:o.mostCommonMood})]})]})]})]})]})}export{Q as default};
